<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://www.gstatic.com/firebasejs/8.3.1/firebase-app.js"></script>

<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
<script src="https://www.gstatic.com/firebasejs/8.3.1/firebase-analytics.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.3.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.3.1/firebase-database.js"></script>

<script>
  // Your web app's Firebase configuration
  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  var firebaseConfig = {
    apiKey: "AIzaSyA4PV9UE-ue1-PWmlE7UMK1Zsi-5EiK6X8",
    authDomain: "hackthon-8ea4b.firebaseapp.com",
    projectId: "hackthon-8ea4b",
    storageBucket: "hackthon-8ea4b.appspot.com",
    messagingSenderId: "940844216417",
    appId: "1:940844216417:web:c7780d1afb1006ebcf7a20",
    measurementId: "G-7D418CTVEM"
  };
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  firebase.analytics();
</script>
<!-- UIkit CSS -->
<script src="//cdnjs.cloudflare.com/ajax/libs/list.js/2.3.1/list.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/uikit@3.6.18/dist/css/uikit.min.css" />
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
crossorigin=""/>
<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
   integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
   crossorigin=""></script>
<!-- UIkit JS -->
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/uikit@3.6.18/dist/js/uikit.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/uikit@3.6.18/dist/js/uikit-icons.min.js"></script>



    <!-- Compiled and minified CSS -->
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css"> 

    <!-- Compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    
    <title id="title">Dashboard</title>
    <script src="js/dash.js"></script>
    <script src="js/index.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/uikit@3.6.18/dist/css/uikit.min.css" />
    <link rel="stylesheet" href="css/style.css">
    
</head>
<body>
    <nav class="z-depth-0">
        <div class="nav-wrapper z-depth-0" >
          <a href="Dash.html" id="logo" class="brand-logo center">Ge0tagger</a>
          <a id="ham" href="#" data-target="mobile-links" class="sidenav-trigger  "><i class="material-icons">menu</i></a>
          <ul id="nav-mobile" class="right ">
            <li ><a id="search" href="#" uk-search-icon uk-toggle><i class="material-icons" >search</i></a></li>
          </ul>
          
        </div>
      </nav>
     

  <ul id="mobile-links" class="sidenav ">
    <li><div class="user-view">
      <div class="background">
        
      </div>
      <a href="#user"><img class="circle" src="images/yuna.jpg"></a>
      <a href="#name"><span id="infoname" class="white-text name"></span></a>
      <a href="#email"><span id="infoemail" class="white-text email"></span></a>
    </div></li>
    <li><a href="Problem.html">Search Problems</a></li>
    <li><a href="Setting.html">Settings</a></li>
    
    <li><a onclick="login.logout()" class="waves-effect" href="#">Log Out</a></li>
</ul>
  
    <h1 id='welcome'>welcome back</h1>
    <!-- <div id="aligned">
      <span uk-search-icon></span><form class="uk-search uk-search-small">
      
      <input class="uk-search-input" type="search" placeholder="Search">
  </form></div> -->
  <div id="modal-full" class="uk-modal-full uk-modal" uk-modal>
    <div class="uk-modal-dialog uk-flex uk-flex-center uk-flex-middle" uk-height-viewport>
        <button class="uk-modal-close-full" type="button" uk-close></button>
        <form class="uk-search uk-search-large">
            <input class="uk-search-input uk-text-center" type="search" placeholder="Search" autofocus>
        </form>
    </div>
</div>
   

    
    <div id='align'><div id="mapid"></div></div>
<script type="text/javascript">
if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(showPosition);
          } else {
            console.log("Geolocation is not supported by this browser.");
            
          }
          function showPosition(position) {
            console.log(position.coords.longitude);
            console.log(position.coords.latitude);
            
          
var mymap = L.map('mapid',{ zoomControl: false, minZoom: 12 }).setView([-83.06200108196722, 40.113337532786886],0);

    L.tileLayer('https://api.maptiler.com/maps/streets/{z}/{x}/{y}@2x.png?key=OjZZ4hlCy05Bf5ITef5N',{
        //attribution: '<a href="https://www.maptiler.com/copyright/" target="_blank">&copy; MapTiler</a> <a href="https://www.openstreetmap.org/copyright" target="_blank">&copy; OpenStreetMap contributors</a>'
    }).addTo(mymap);

    var mae = L.marker([position.coords.latitude,position.coords.longitude]).addTo(mymap);
    var id, target, option;
var long,lat
navigator.geolocation.getCurrentPosition(function(position) {
    var print = document.getElementById('print'); 
    console.log(position.coords.longitude);
     lat = position.coords.latitude;
     long =  position.coords.longitude;
    console.log(position.coords.latitude);
    mae.setLatLng([position.coords.latitude,position.coords.longitude]);
    print.innerText = "longitude: " + position.coords.longitude + "latitude: " + position.coords.latitude;
});
function success(pos) {
  var crd = pos.coords;
 var latlng = [crd.latitude,crd.longitude]
  navigator.geolocation.getCurrentPosition(function(position) {
    var print = document.getElementById('print'); 
    console.log(crd.longitude);
     lat = crd.latitude;
     long =  crd.longitude;
    console.log(crd.latitude);
    mae.setLatLng(latlng);
    print.innerText = "longitude: " + position.coords.longitude + "latitude: " + position.coords.latitude;
});
};

function error(err) {
  console.warn('ERROR(' + err.code + '): ' + err.message);
};

target = {
  latitude : lat,
  longitude: long,
}

options = {
  enableHighAccuracy: true,
  timeout: 5000,
  maximumAge: 0
};

id = navigator.geolocation.watchPosition(success, error, options); 
    setTimeout(myFunction, 5000);
    function myFunction() {
        mymap.panTo([position.coords.latitude,position.coords.longitude]);
        ref = firebase.database().ref().child('locations');
        ref.once("value", snap=> {
        snap.forEach(r=>{
           
            console.log(r.val().log);
           
            var circle = L.circle([r.val().lat,r.val().long], {
    color: 'red',
    fillColor: '#f03',
    fillOpacity: 0.5,
    radius: 500
}).addTo(mymap);
        });
    });

        

      
        
    
    }
}
    </script> 
   
 
</body>
</html>